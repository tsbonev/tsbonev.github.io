/* Layout */
html, body {
	height: 100%;
	margin: 0;
	font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
/* Toolbar layout regions */
.toolbar { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 8px; padding: 8px 12px; border-bottom: 1px solid #e0e0e0; background: #fafafa; }
.toolbar .left { display: inline-flex; align-items: center; gap: 8px; }
.toolbar .center { display: inline-flex; align-items: center; gap: 12px; justify-content: center; }
.toolbar .right { display: inline-flex; align-items: center; gap: 8px; justify-content: flex-end; }
.toolbar .spacer { display: none; }
.toolbar label.snap, .toolbar label.grid-size, .toolbar label.show-grid { display: inline-flex; align-items: center; gap: 6px; }
.toolbar .divider { display: inline-block; width: 1px; height: 20px; background: #e5e7eb; margin: 0 6px; }
.layout {
	display: grid;
	grid-template-columns: 1fr 320px;
	height: calc(100% - 49px);
}
.canvas-wrap { 
	position: relative; 
	overflow: auto; 
	background: #f5f7fb; 
	width: 100%;
	height: 100%;
}
/* Grid visuals */
.canvas {
	position: absolute;
	outline: none;
	--grid: 24px;
	background-color: #f5f7fb;
	background-image:
		linear-gradient(to right, rgba(41,98,255,0.08) 1px, transparent 1px),
		linear-gradient(to bottom, rgba(41,98,255,0.08) 1px, transparent 1px);
	background-size: var(--grid) var(--grid), var(--grid) var(--grid);
	transform-origin: top left;
	top: 0;
	left: 0;
}
.sidebar {
	border-left: 1px solid #e0e0e0;
	padding: 12px;
	background: #fff;
	overflow: auto;
}

/* Table node */
.table {
	position: absolute;
	border: 2px solid #4257b2;
	background: #ffffff;
	box-shadow: 0 2px 8px rgba(0,0,0,0.08);
	cursor: grab;
}
.table.circle { border-radius: 50%; }
.table.rect { border-radius: 8px; }
.table.rect.flat-top { border-top-left-radius: 0; border-top-right-radius: 0; }
.table.rect.flat-right { border-top-right-radius: 0; border-bottom-right-radius: 0; }
.table.rect.flat-bottom { border-bottom-left-radius: 0; border-bottom-right-radius: 0; }
.table.rect.flat-left { border-top-left-radius: 0; border-bottom-left-radius: 0; }
.table.dragging { cursor: grabbing; opacity: 0.9; }
.table.selected { box-shadow: 0 0 0 3px rgba(66,87,178,0.2); }

/* Separator node */
.separator {
	position: absolute;
	border: 4px solid #666666;
	background: #e0e0e0;
	background-image: repeating-linear-gradient(
		45deg,
		transparent,
		transparent 8px,
		rgba(0,0,0,0.1) 8px,
		rgba(0,0,0,0.1) 16px
	);
	cursor: grab;
}
.separator.dragging { cursor: grabbing; opacity: 0.9; }
.separator.selected { box-shadow: 0 0 0 3px rgba(102,102,102,0.2); }

/* selection ring */
@keyframes dash-rotate { to { transform: rotate(360deg); } }
.table.selected::after {
	content: '';
	position: absolute;
	left: -6px; top: -6px; right: -6px; bottom: -6px;
	border: 2px dashed #3b82f6;
	border-radius: inherit;
	pointer-events: none;
	animation: dash-rotate 4s linear infinite;
}

/* Disable old selection ring */
.table.selected::after { display: none; }

/* Animated selection outline via SVG */
@keyframes dash-offset {
	to { stroke-dashoffset: -200; }
}
.selection-outline {
	position: absolute;
	left: -6px; top: -6px; right: -6px; bottom: -6px;
	pointer-events: none;
}
.selection-outline svg { width: 100%; height: 100%; display: block; }
.selection-outline path, .selection-outline circle, .selection-outline rect {
	fill: none;
	stroke: #3b82f6;
	stroke-width: 2;
	stroke-dasharray: 6 6;
	animation: dash-offset 6s linear infinite;
}

/* Overlap hint */
.table.overlap { box-shadow: 0 0 0 3px rgba(239,68,68,0.4); }
.separator.overlap { box-shadow: 0 0 0 3px rgba(239,68,68,0.4); }

/* Seats */
.seat {
	position: absolute;
	width: 28px;
	height: 28px;
	border-radius: 50%;
	border: 2px solid #607d8b;
	background: #eceff1;
	transform: translate(-50%, -50%);
	pointer-events: auto;
	display: flex;
	align-items: center;
	justify-content: center;
	font-weight: 700;
	font-size: 12px;
	line-height: 1;
	color: #ffffff;
	text-shadow: 0 1px 1px rgba(0,0,0,0.35);
	user-select: none;
}
.seat.assigned { border-color: rgba(0,0,0,0.25); }
.seat.drop-target { box-shadow: 0 0 0 3px rgba(59,130,246,0.35); }

/* Resize handles */
.handle-e, .handle-s {
	position: absolute;
	width: 10px;
	height: 10px;
	background: #4257b2;
	border-radius: 2px;
}
.handle-e {
	right: -5px;
	top: 50%;
	transform: translateY(-50%);
	cursor: ew-resize;
}
.handle-s {
	bottom: -5px;
	left: 50%;
	transform: translateX(-50%);
	cursor: ns-resize;
}

/* Guest sidebar */
.guest-form { display: flex; gap: 6px; margin: 8px 0 12px; }
.guest-form input[type="text"] { flex: 1; padding: 6px 8px; }
.guest-controls { display: flex; gap: 12px; align-items: center; margin-bottom: 8px; }
.guest-controls .filter { display: flex; align-items: center; gap: 6px; }
.table-controls { display: grid; gap: 8px; align-items: start; margin: 8px 0 12px; }
.table-controls input[type="number"] { width: 80px; padding: 4px 6px; }
.rect-controls { display: grid; gap: 6px; padding: 8px; border: 1px dashed #e5e7eb; border-radius: 6px; }
.side-group { display: grid; grid-template-columns: repeat(4, auto); gap: 8px; align-items: center; }
.guest-list { display: grid; gap: 8px; }
.guest-row { display: grid; grid-template-columns: 1fr auto auto; gap: 6px; align-items: center; padding: 6px 4px; border: 1px solid #e5e7eb; border-radius: 6px; }
.guest-row input[type="text"] { width: 100%; padding: 4px 6px; }
.guest-row .status { color: #666; font-size: 12px; }

/* Seat popover */
.popover {
	position: absolute;
	background: #fff;
	border: 1px solid #e5e7eb;
	border-radius: 6px;
	box-shadow: 0 6px 24px rgba(0,0,0,0.12);
	padding: 8px;
	z-index: 1000;
	min-width: 200px;
}
.popover .row { display: flex; gap: 8px; align-items: center; margin-bottom: 6px; }
.popover .row:last-child { margin-bottom: 0; }
.popover select { flex: 1; }

/* Misc */
button { cursor: pointer; }
/* remove old import label hack */
.import-label { display: none; }
#importInput { position: absolute; left: 0; top: 0; opacity: 0; width: 100%; height: 100%; cursor: pointer; }


/* CSV controls */
.guest-csv { display: flex; gap: 6px; margin-bottom: 8px; }

/* Print styles for PDF export */
@media print {
	body { margin: 0; }
	.toolbar, .sidebar { display: none !important; }
	.canvas-wrap { position: static; overflow: visible; }
	.canvas { min-width: auto; min-height: auto; width: 100vw; height: 100vh; }
}

/* Improve print color fidelity */
@media print {
	*, *::before, *::after { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
}
